{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.4", "generated_at": "2025-07-15T17:25:04.220977Z", "invocation_id": "ae18f688-7ed5-4200-8364-cca68ac2e4af", "invocation_started_at": "2025-07-15T17:24:22.596040Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:03.469865Z", "completed_at": "2025-07-15T17:25:03.507490Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:03.509491Z", "completed_at": "2025-07-15T17:25:03.509491Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04479217529296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.telegram_analysis.stg_telegram_messages", "compiled": true, "compiled_code": "WITH raw_data AS (\n    SELECT * FROM \"telegram_data\".\"public\".\"telegram_messages\"\n)\n\nSELECT\n    (message_json->>'id')::INT AS message_id,\n    message_json->>'text' AS message_text,\n    message_json->>'date' AS message_date,\n    channel  -- Make sure this line exists\nFROM raw_data\nWHERE message_json->>'text' IS NOT NULL", "relation_name": "\"telegram_data\".\"raw\".\"stg_telegram_messages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:03.550141Z", "completed_at": "2025-07-15T17:25:03.586672Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:03.590265Z", "completed_at": "2025-07-15T17:25:03.590265Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06692266464233398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.telegram_analysis.not_null_stg_telegram_messages_message_date.5e47e63b14", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect message_date\nfrom \"telegram_data\".\"raw\".\"stg_telegram_messages\"\nwhere message_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:03.576505Z", "completed_at": "2025-07-15T17:25:03.588671Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:03.592265Z", "completed_at": "2025-07-15T17:25:03.592265Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06692171096801758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.telegram_analysis.not_null_stg_telegram_messages_message_id.9b3fea71d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect message_id\nfrom \"telegram_data\".\"raw\".\"stg_telegram_messages\"\nwhere message_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:03.599264Z", "completed_at": "2025-07-15T17:25:03.618590Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:03.621002Z", "completed_at": "2025-07-15T17:25:03.621002Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026737689971923828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.telegram_analysis.not_null_stg_telegram_messages_message_text.e53a8c7e68", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect message_text\nfrom \"telegram_data\".\"raw\".\"stg_telegram_messages\"\nwhere message_text is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:03.607428Z", "completed_at": "2025-07-15T17:25:03.620001Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:03.622999Z", "completed_at": "2025-07-15T17:25:03.622999Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02773594856262207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.telegram_analysis.unique_stg_telegram_messages_message_id.1c7c22c9a1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    message_id as unique_field,\n    count(*) as n_records\n\nfrom \"telegram_data\".\"raw\".\"stg_telegram_messages\"\nwhere message_id is not null\ngroup by message_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:03.533832Z", "completed_at": "2025-07-15T17:25:03.711722Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:03.742984Z", "completed_at": "2025-07-15T17:25:03.742984Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.22379350662231445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.telegram_analysis.dim_channels", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT\n    ROW_NUMBER() OVER () AS channel_id,\n    channel AS channel_name\nFROM \"telegram_data\".\"raw\".\"stg_telegram_messages\"\nWHERE channel IS NOT NULL", "relation_name": "\"telegram_data\".\"raw\".\"dim_channels\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:03.541092Z", "completed_at": "2025-07-15T17:25:03.761196Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:03.777533Z", "completed_at": "2025-07-15T17:25:03.777533Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.25618910789489746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.telegram_analysis.dim_dates", "compiled": true, "compiled_code": "\n\nWITH raw_dates AS (\n    SELECT DISTINCT\n        TO_DATE(message_date, 'YYYY-MM-DD\"T\"HH24:MI:SS') AS message_date\n    FROM \"telegram_data\".\"raw\".\"stg_telegram_messages\"\n    WHERE message_date IS NOT NULL\n),\n\ndate_range AS (\n    SELECT generate_series(\n        (SELECT MIN(message_date) - INTERVAL '1 year' FROM raw_dates),\n        (SELECT MAX(message_date) + INTERVAL '1 year' FROM raw_dates),\n        INTERVAL '1 day'\n    )::DATE AS message_date\n)\n\nSELECT\n    message_date AS date,\n    EXTRACT(YEAR FROM message_date) AS year,\n    EXTRACT(QUARTER FROM message_date) AS quarter,\n    EXTRACT(MONTH FROM message_date) AS month,\n    TO_CHAR(message_date, 'Month') AS month_name,\n    EXTRACT(WEEK FROM message_date) AS week_of_year,\n    EXTRACT(DAY FROM message_date) AS day_of_month,\n    EXTRACT(ISODOW FROM message_date) AS day_of_week,\n    TO_CHAR(message_date, 'Day') AS weekday_name,\n    CASE WHEN EXTRACT(ISODOW FROM message_date) IN (6,7) THEN TRUE ELSE FALSE END AS is_weekend\nFROM (\n    SELECT message_date FROM raw_dates\n    UNION\n    SELECT message_date FROM date_range\n) AS all_dates\nORDER BY message_date", "relation_name": "\"telegram_data\".\"raw\".\"dim_dates\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:03.779533Z", "completed_at": "2025-07-15T17:25:03.857535Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:03.867673Z", "completed_at": "2025-07-15T17:25:03.867673Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11247873306274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.telegram_analysis.not_null_dim_channels_channel_name.3be3fa8f5b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_name\nfrom \"telegram_data\".\"raw\".\"dim_channels\"\nwhere channel_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:03.766532Z", "completed_at": "2025-07-15T17:25:03.826531Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:03.863668Z", "completed_at": "2025-07-15T17:25:03.863668Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.10947155952453613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.telegram_analysis.fct_messages", "compiled": true, "compiled_code": "SELECT\n    message_id,\n    message_text,\n    message_date,\n    c.channel_id\nFROM \"telegram_data\".\"raw\".\"stg_telegram_messages\" m\nJOIN \"telegram_data\".\"raw\".\"dim_channels\" c ON m.channel = c.channel_name", "relation_name": "\"telegram_data\".\"raw\".\"fct_messages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:03.780752Z", "completed_at": "2025-07-15T17:25:03.861895Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:03.880665Z", "completed_at": "2025-07-15T17:25:03.881665Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.12246990203857422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.telegram_analysis.unique_dim_channels_channel_name.e57614abc8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    channel_name as unique_field,\n    count(*) as n_records\n\nfrom \"telegram_data\".\"raw\".\"dim_channels\"\nwhere channel_name is not null\ngroup by channel_name\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:03.887660Z", "completed_at": "2025-07-15T17:25:03.975720Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:03.980905Z", "completed_at": "2025-07-15T17:25:03.980905Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10722923278808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.telegram_analysis.unique_dim_dates_date.bab48d2068", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date as unique_field,\n    count(*) as n_records\n\nfrom \"telegram_data\".\"raw\".\"dim_dates\"\nwhere date is not null\ngroup by date\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:03.899821Z", "completed_at": "2025-07-15T17:25:03.978722Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:03.982906Z", "completed_at": "2025-07-15T17:25:03.982906Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.12337446212768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.telegram_analysis.not_null_dim_dates_date.e2decc9d39", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date\nfrom \"telegram_data\".\"raw\".\"dim_dates\"\nwhere date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:03.984907Z", "completed_at": "2025-07-15T17:25:04.013781Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:04.018782Z", "completed_at": "2025-07-15T17:25:04.018782Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04406237602233887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.telegram_analysis.not_null_fct_messages_channel_id.6c644bffff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_id\nfrom \"telegram_data\".\"raw\".\"fct_messages\"\nwhere channel_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:03.995342Z", "completed_at": "2025-07-15T17:25:04.050236Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:04.055237Z", "completed_at": "2025-07-15T17:25:04.055237Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07751727104187012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.telegram_analysis.not_null_fct_messages_message_date.e5a43e40df", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect message_date\nfrom \"telegram_data\".\"raw\".\"fct_messages\"\nwhere message_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:04.022732Z", "completed_at": "2025-07-15T17:25:04.053237Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:04.060279Z", "completed_at": "2025-07-15T17:25:04.060279Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04949831962585449, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.telegram_analysis.not_null_fct_messages_message_id.de346706b5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect message_id\nfrom \"telegram_data\".\"raw\".\"fct_messages\"\nwhere message_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:04.035979Z", "completed_at": "2025-07-15T17:25:04.058004Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:04.064277Z", "completed_at": "2025-07-15T17:25:04.064277Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04849886894226074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.telegram_analysis.not_null_fct_messages_message_text.f83c22725d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect message_text\nfrom \"telegram_data\".\"raw\".\"fct_messages\"\nwhere message_text is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:04.066276Z", "completed_at": "2025-07-15T17:25:04.094132Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:04.104358Z", "completed_at": "2025-07-15T17:25:04.104358Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05212044715881348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.telegram_analysis.relationships_fct_messages_channel_id__channel_id__ref_dim_channels_.35fbdd29f9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select channel_id as from_field\n    from \"telegram_data\".\"raw\".\"fct_messages\"\n    where channel_id is not null\n),\n\nparent as (\n    select channel_id as to_field\n    from \"telegram_data\".\"raw\".\"dim_channels\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:04.097133Z", "completed_at": "2025-07-15T17:25:04.201977Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:04.202977Z", "completed_at": "2025-07-15T17:25:04.202977Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.11527276039123535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.telegram_analysis.test_no_future_dates", "compiled": true, "compiled_code": "SELECT *\nFROM \"telegram_data\".\"raw\".\"fct_messages\"\nWHERE message_date::date > CURRENT_DATE", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-15T17:25:04.106360Z", "completed_at": "2025-07-15T17:25:04.205976Z"}, {"name": "execute", "started_at": "2025-07-15T17:25:04.206978Z", "completed_at": "2025-07-15T17:25:04.207978Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11684727668762207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.telegram_analysis.unique_fct_messages_message_id.655aa1a48d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    message_id as unique_field,\n    count(*) as n_records\n\nfrom \"telegram_data\".\"raw\".\"fct_messages\"\nwhere message_id is not null\ngroup by message_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 8.6479651927948, "args": {"show_resource_report": false, "populate_cache": true, "use_colors": true, "version_check": true, "log_format_file": "debug", "project_dir": "E:\\10_Academy\\Week-07\\telegram-data-pipeline-dbt-dagster-yolov8\\src\\dbt_project", "static": false, "use_fast_test_edges": false, "require_batched_execution_for_custom_microbatch_strategy": false, "write_json": true, "log_file_max_bytes": 10485760, "skip_nodes_if_on_run_start_fails": false, "send_anonymous_usage_stats": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "cache_selected_only": false, "empty_catalog": false, "invocation_command": "dbt docs generate", "defer": false, "exclude": [], "use_colors_file": true, "state_modified_compare_more_unrendered_values": false, "validate_macro_args": false, "quiet": false, "upload_to_artifacts_ingest_api": false, "printer_width": 80, "partial_parse_file_diff": true, "macro_debugging": false, "log_level": "info", "which": "generate", "log_level_file": "debug", "compile": true, "select": [], "source_freshness_run_project_hooks": true, "vars": {}, "introspect": true, "require_all_warnings_handled_by_warn_error": false, "partial_parse": true, "profiles_dir": "E:\\10_Academy\\Week-07\\telegram-data-pipeline-dbt-dagster-yolov8\\src\\dbt_project", "state_modified_compare_vars": false, "strict_mode": false, "favor_state": false, "show_all_deprecations": false, "indirect_selection": "eager", "print": true, "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "require_yaml_configuration_for_mf_time_spines": false, "log_path": "E:\\10_Academy\\Week-07\\telegram-data-pipeline-dbt-dagster-yolov8\\src\\dbt_project\\logs", "static_parser": true, "require_resource_names_without_spaces": true, "require_nested_cumulative_type_params": false}}