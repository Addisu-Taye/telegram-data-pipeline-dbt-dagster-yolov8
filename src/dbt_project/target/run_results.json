{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.4", "generated_at": "2025-07-13T19:50:18.496503Z", "invocation_id": "d104941a-c60a-4f5c-acc3-aa6630f3a7fc", "invocation_started_at": "2025-07-13T19:50:06.553162Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-13T19:50:15.882198Z", "completed_at": "2025-07-13T19:50:15.914304Z"}, {"name": "execute", "started_at": "2025-07-13T19:50:15.914304Z", "completed_at": "2025-07-13T19:50:16.924826Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.048147201538086, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.telegram_analysis.stg_telegram_messages", "compiled": true, "compiled_code": "WITH raw_data AS (\n    SELECT *\n    FROM \"telegram_data\".\"public\".\"telegram_messages\"\n)\n\nSELECT\n    (message_json->>'id')::INT AS message_id,\n    message_json->>'message' AS message_text,\n    message_json->>'date' AS message_date,\n    channel\nFROM raw_data\nWHERE message_json->>'message' IS NOT NULL", "relation_name": "\"telegram_data\".\"public\".\"stg_telegram_messages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-13T19:50:16.949344Z", "completed_at": "2025-07-13T19:50:16.968470Z"}, {"name": "execute", "started_at": "2025-07-13T19:50:16.974904Z", "completed_at": "2025-07-13T19:50:17.401935Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.46058082580566406, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.telegram_analysis.dim_channels", "compiled": true, "compiled_code": "SELECT DISTINCT\n    ROW_NUMBER() OVER () AS channel_id,\n    channel AS channel_name\nFROM \"telegram_data\".\"public\".\"stg_telegram_messages\"", "relation_name": "\"telegram_data\".\"public\".\"dim_channels\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-13T19:50:17.427779Z", "completed_at": "2025-07-13T19:50:17.438777Z"}, {"name": "execute", "started_at": "2025-07-13T19:50:17.440777Z", "completed_at": "2025-07-13T19:50:17.590817Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.17003870010375977, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.telegram_analysis.fct_messages", "compiled": true, "compiled_code": "SELECT\n    message_id,\n    message_text,\n    message_date,\n    c.channel_id\nFROM \"telegram_data\".\"public\".\"stg_telegram_messages\" m\nJOIN \"telegram_data\".\"public\".\"dim_channels\" c ON m.channel = c.channel_name", "relation_name": "\"telegram_data\".\"public\".\"fct_messages\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-07-13T19:50:16.957471Z", "completed_at": "2025-07-13T19:50:16.972478Z"}, {"name": "execute", "started_at": "2025-07-13T19:50:16.986598Z", "completed_at": "2025-07-13T19:50:17.391932Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.2077608108520508, "adapter_response": {}, "message": "Database Error in model dim_dates (models\\marts\\dim_dates.sql)\n  column \"message_date\" does not exist\n  LINE 35:         (SELECT MAX(TO_DATE(message_date::text, 'YYYY-MM-DD'...\n                                       ^\n  compiled code at target\\run\\telegram_analysis\\models\\marts\\dim_dates.sql", "failures": null, "unique_id": "model.telegram_analysis.dim_dates", "compiled": true, "compiled_code": "-- File Path: src/dbt_project/models/marts/dim_dates.sql\n-- Date: 10 July 2025\n-- Developed by: Addisu Taye Dadi\n-- Purpose: Create a date dimension table to support time-based analysis in the data warehouse.\n-- Key Features:\n-- - Generates a full calendar of dates with attributes useful for reporting and analytics.\n-- - Includes year, quarter, month, week, day, and weekday information.\n-- - Used as a dimension table joined to fact tables like fct_messages.\n\n\n\nWITH date_spine AS (\n    -- Generate a list of all unique message dates from the staging messages table\n    SELECT DISTINCT\n        (TO_DATE(message_date::text, 'YYYY-MM-DD')) AS date\n    FROM \"telegram_data\".\"public\".\"stg_telegram_messages\"\n    WHERE message_date IS NOT NULL\n\n    UNION\n\n    -- Optional: Add future dates or fill gaps using a date range\n    SELECT generate_series(\n        (SELECT MIN(TO_DATE(message_date::text, 'YYYY-MM-DD')) - INTERVAL '1 year' FROM \"telegram_data\".\"public\".\"stg_telegram_messages\"),\n        (SELECT MAX(TO_DATE(message_date::text, 'YYYY-MM-DD')) + INTERVAL '1 year'),\n        INTERVAL '1 day'\n    )::DATE\n)\n\nSELECT\n    date,\n    EXTRACT(YEAR FROM date) AS year,\n    EXTRACT(QUARTER FROM date) AS quarter,\n    EXTRACT(MONTH FROM date) AS month,\n    TO_CHAR(date, 'Month') AS month_name,\n    EXTRACT(WEEK FROM date) AS week_of_year,\n    EXTRACT(DAY FROM date) AS day_of_month,\n    EXTRACT(ISODOW FROM date) AS day_of_week, -- Monday = 1, Sunday = 7\n    TO_CHAR(date, 'Day') AS weekday_name,\n    CASE WHEN EXTRACT(ISODOW FROM date) IN (6,7) THEN TRUE ELSE FALSE END AS is_weekend\nFROM date_spine\nORDER BY date", "relation_name": "\"telegram_data\".\"public\".\"dim_dates\"", "batch_results": null}], "elapsed_time": 5.112564325332642, "args": {"printer_width": 80, "use_colors_file": true, "log_level_file": "debug", "macro_debugging": false, "invocation_command": "dbt run", "populate_cache": true, "partial_parse": true, "require_resource_names_without_spaces": true, "use_fast_test_edges": false, "empty": false, "which": "run", "require_nested_cumulative_type_params": false, "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "static_parser": true, "use_colors": true, "require_all_warnings_handled_by_warn_error": false, "skip_nodes_if_on_run_start_fails": false, "log_level": "info", "print": true, "source_freshness_run_project_hooks": true, "cache_selected_only": false, "validate_macro_args": false, "show_resource_report": false, "partial_parse_file_diff": true, "project_dir": "E:\\10_Academy\\Week-07\\telegram-data-pipeline-dbt-dagster-yolov8\\src\\dbt_project", "indirect_selection": "eager", "version_check": true, "exclude": [], "show_all_deprecations": false, "state_modified_compare_vars": false, "strict_mode": false, "require_batched_execution_for_custom_microbatch_strategy": false, "send_anonymous_usage_stats": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "write_json": true, "log_format_file": "debug", "log_file_max_bytes": 10485760, "quiet": false, "vars": {}, "select": [], "require_yaml_configuration_for_mf_time_spines": false, "defer": false, "log_path": "E:\\10_Academy\\Week-07\\telegram-data-pipeline-dbt-dagster-yolov8\\src\\dbt_project\\logs", "profiles_dir": "E:\\10_Academy\\Week-07\\telegram-data-pipeline-dbt-dagster-yolov8\\src\\dbt_project", "upload_to_artifacts_ingest_api": false, "state_modified_compare_more_unrendered_values": false, "introspect": true, "favor_state": false}}